Game Design Document - BIO-CAPSULE
Stato: Integrato con Architettura Unity e Issue Tracking

1. Core Concept e visione:
    - Ruolo del Giocare: Bio-Tecnico / Supervisore di laboratorio.
    - L'Attore (Il Sistema): La Capsula (Isolata), La Pianta (organismo).
    - Filosofia: Il giocatore non "Coltiva" direttamente la pianta ma gestisce le variabili che permettono la vita.
    - Script Core: [Ref: Assets/Scripts/Core/GameManager.cs]

2. Mappatura delle interazioni (User & System):
    A. Azioni Dell'utente (Input):
        → Regolazione climatica [Ref: Assets/Scripts/Controllers/EnvironmentCtrl.cs]:
            ø Azione:
                - Impostazione set-point Termostato (es. target 24°C);
                - Impostazione set-point Umidostato (es. target 60%).
            [⚠️ WARNING: Vedi P-LOGIC-001 Paradosso Termico]

        → Gestione Illuminazione:
            ø Azione:
                - Modifica Spettro (Slider RGB/UV);
                - Posizionamento Fonte (Coordinate X/Y/Z lampada).

        → Input Chimico e Biologico (Dosaggio) [Ref: Assets/Scripts/Controllers/PlantController.cs]:
            ø Azione:
                - Iniezione Soluzione Nutriente (NPK);
                - Iniezione Microbioma (Nanobatteri specifici, es. Decompositori);
                - Iniezione Acqua Pura (Flush).
            [⚠️ WARNING: Vedi P-LOGIC-010 Antagonismo Nutrienti]
            [⚠️ WARNING: Vedi P-LOGIC-013 Deriva pH]

        → Gestione Rifiuti & Manutenzione [Ref: Assets/Scripts/Controllers/WasteManager.cs]:
            ø Azione:
                - Svuotamento Serbatoio Scarti (Waste Tank);
                - Attivazione Drenaggio Manuale (Emergenza).

        → Pianificazione (End Game):
            ø Azione:
                - Creazione di routine controllo manuale non richiesto necessariamente.

    B. Risposte del sistema:
        → Feedback Immediato (Haptic/Visual):
            ø Risposta:
                - Rumore ventole, accensione luci, cambio colore led;
                - Condensa sul vetro (glassmorphism) [Ref: Assets/Art/Shaders/Shader_Condensation];
                - Aggiornamento grafici in tempo reale sulla Dashboard.
            [⚠️ WARNING: Vedi P-DESIGN-006 Cecità da Condensa]

        → Feedback biologico:
            ø Risposta:
                - (Morfogenesi): La pianta orienta le foglie verso la luce (Fototropismo) [Ref: Assets/Scripts/Procedural/LSystemGenerator.cs];
                - (Turgore): Le foglie si afflosciano se VWC < 10%;
                - (Cromatica): Le foglie cambiano cromatura (clorosi) se Azoto < Soglia.

3. Logica Indipendente (Motore logico non visibile):
    A. Cicli Ambientali Autonomi [Ref: Assets/Scripts/Logic/ClimateLogic.cs]:
        - Ciclo Idrologico & Drenaggio:
            → Evaporazione, Saturazione, Condensazione;
            → Accumulo e Drenaggio: SE Umidità Suolo > Capacità -> Scarto nel Serbatoio;
            → Trasporto Sali: Il drenaggio sposta l'EC nel serbatoio scarti.
        - Termodinamica:
            → Dispersione termica o accumulo calore.

    B. Cicli Biologici Autonomi [Ref: Assets/Scripts/Logic/MetabolismLogic.cs]:
        - Sviluppo procedurale:
            → Se Energia > CostoCreazioneNodo, il sistema genera una nuova mesh.
        - Respirazione:
            → Consumo costante di zuccheri (Metabolismo Basale).
            [⚠️ WARNING: Vedi P-LOGIC-009 Asfissia CO2]

    C. Cicli Microbioma [Ref: Assets/Scripts/Controllers/PlantController.cs]:
        - Ciclo del Carbonio:
            → Rilevamento Biomassa Morta e decomposizione tramite Nanobatteri;
            → Rilascio Nutrienti (Loop chiuso).

    D. Entropia e Imprevisti:
        - Guasti Hardware (Pompa bloccata).
        - Patogeni (Muffe se Umidità > 90%).

4. Obiettivi e Progressione (Game Loop):
    ¶ Fase 1: Survival (Omeostasi).
    ¶ Fase 2: Ottimizzazione e Fioritura.
    ¶ Fase 3: Espansione e Automazione.
        [⚠️ WARNING: Vedi P-LOGIC-012 Senescenza Piante Annuali]
    - Endgame: Ibridazione.

5. Struttura Dati (High Level - Implementation Map):
    Collegamento diretto tra concetti e file C# in Assets/Scripts/Data/

    | Entità                | Script C# Corrispondente       | Dati Chiave Gestiti                     |
    |-----------------------|--------------------------------|-----------------------------------------|
    | Environment           | EnvironmentData.cs             | temperature, humidity, co2Level, soilEC |
    | Plant Model           | PlantData.cs                   | vigorIndex, storedEnergy, rootMass      |
    | DNA Specie            | PlantSpecies.cs (ScriptableObj)| nodeEnergyCost, optimalTemp, growthRule |
    | Costanti Universali   | GameConfig.cs                  | BASE_METABOLIC_RATE, TICK_INTERVAL      |
    | Gestione Tempo        | TimeManager.cs                 | Timestamp, DeltaTime                    |

6. Fase Preliminare: Selezione Genomica (Pre-Game Setup):
    A. Il Catalogo Semi (Database Statico) [Ref: Assets/Resources/SpeciesData/]:
        - Attore: Utente.
        - Interfaccia: "La banca dei semi".
        - Dati Scheda:
            ø Nome: Helianthus Annuus.
            ø Difficoltà: Bassa.
            ø Coefficienti Genetici: Definizione matematica tolleranze.
            ø Fattore Limitante: Parametro di stress principale.

    B. Input e Conferma:
        - Azione: Selezione Seme.
        - Backend (Data Injection):
            → Caricamento Template ScriptableObject;
            → Istanziazione PlantData;
            ø Copia Valori:
                - VigorIndex Iniziale = 100% (Sostituisce Health);
                - NodeEnergyCost: Sostituisce GrowthRate. Definisce costo energetico per nuovo nodo (es. 50 unità veloce, 500 lenta).
                - L-System Rules: Regole geometriche.

    C. Configurazione Automatica (Stato Dormienza):
        - Stato Iniziale: Seme "Dormiente" (Metabolismo = 0).
        - Loop Iniziale: Tempo illimitato per setup clima.
        - Trigger: Utente preme "AVVIA GERMINAZIONE".
        [⚠️ WARNING: Vedi P-LOGIC-011 Incoerenza Tasto Avvio]
