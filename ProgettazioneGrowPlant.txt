TITOLO: BIO-CAPSULE - Game Design Document (v2.1)
TIPO: Simulatore Scientifico Hardcore (Hard Sci-Fi)
STATO: Ready for Development (Tutti i problemi risolti in fase design)

1. CORE CONCEPT E VISIONE
-------------------------------------------------------------------------
- Ruolo del Giocatore: Operatore Bio-Sistemico (gestione remota).
- L'Attore (Il Sistema): Un ecosistema chiuso termodinamicamente isolato.
- Filosofia: "Trust No One, Measure Everything". La natura è ostile, l'hardware è inaffidabile. Non si "coltiva" la pianta direttamente; si gestiscono le variabili chimico-fisiche (VPD, Joule, Moli) per permettere l'omeostasi. La pianta muore se le leggi della fisica vengono ignorate.
- Script Core: [Ref: Assets/Scripts/Core/GameManager.cs]

2. MAPPATURA INTERAZIONI (USER & SYSTEM)
-------------------------------------------------------------------------
A. GESTIONE HARDWARE E POSIZIONAMENTO
   - Regolazione Climatica (Termodinamica):
       - Azione: Regolazione Input Energetico (Watt) di Riscaldatori/Raffreddatori.
       - Azione: Controllo Ventole per manipolare il VPD (Vapor Pressure Deficit), non solo l'umidità relativa.
       [RISOLTO: P-LOGIC-001 Paradosso Termico]

   - Gestione Illuminazione e Posizionamento:
       - Azione: Modifica Spettro (RGB / UV / IR).
       - Azione: Attivazione "Safe Light" (Luce Verde 520nm) per osservazioni notturne.
       - [P-LOGIC-015] Posizionamento Luce (Asse Z): Regolazione millimetrica altezza lampada.
         Fisica: Legge dell'Inverso del Quadrato (1/d²). Spostare la lampada di 5cm cambia drasticamente i PPFD.
         Errore: Troppo vicina = Bruciatura termica/luminosa. Troppo lontana = Eziolamento (Stretch).

   - [P-DESIGN-007] Manutenzione Sensori:
       - Falla: I sensori pH/EC non sono perfetti. "Driftano" (perdono precisione) col tempo.
       - Azione: "Calibrazione" periodica con liquido buffer standard per ripristinare l'accuratezza.

B. CHIMICA E DOSAGGIO
   - Input Chimico:
       - Azione: Iniezione Soluzione NPK + Micronutrienti.
       - Azione: Correzione pH (Up/Down) per contrastare la deriva cationica naturale.
       - Azione: Flush (Lisciviazione) con acqua pura per lavare via i sali tossici.

   - [P-LOGIC-014] Gestione Ossigeno (Ipossia):
       - Fisica: Legge di Henry. La solubilità dell'Ossigeno Disciolto (DO) crolla se T > 25°C.
       - Azione: Monitorare temperatura acqua. Raffreddare il serbatoio per evitare marciume radicale (Pythium).

C. BIOLOGIA E RIPRODUZIONE
   - Gestione Riproduttiva:
       - Azione: Impollinazione Manuale ("Shake" o "Brush") necessaria in isolamento.

   - [P-LOGIC-016] Monitoraggio Stomi (Shutdown Meccanico):
       - Fisica: Se il VPD è errato (>1.8 kPa o <0.4 kPa), la pianta chiude gli stomi per protezione.
       - Conseguenza: Assorbimento CO2 = 0 anche se l'ambiente è ricco di gas. Stallo fotosintetico.

3. MOTORE DI SIMULAZIONE (LOGICA INVISIBILE)
-------------------------------------------------------------------------
A. TERMODINAMICA E GAS [Ref: Assets/Scripts/Logic/Thermodynamics.cs]
   - Paradosso Termico: Calcolo accumulo calore (Joule) emesso dalle luci vs dispersione passiva vetro.
   - Asfissia da CO2: La capsula ha un volume d'aria finito. La fotosintesi consuma moli reali.
   - Dew Point: Il vetro si appanna solo se TempVetro < DewPoint (Formula di Magnus).

B. IDROLOGIA E CHIMICA DEL SUOLO [Ref: Assets/Scripts/Logic/HydroponicsMath.cs]
   - Matrice di Mulder (Antagonismo): L'assorbimento nutrienti segue la tabella ionica (es. K blocca Mg).
   - Deriva del pH: L'assorbimento altera il pH (scambio cationico/anionico).
   - Osmosi: Sali in eccesso (EC alto) disidratano la pianta estraendo acqua dalle radici.

C. BIOLOGIA E METABOLISMO [Ref: Assets/Scripts/BioSystem/Metabolism.cs]
   - VigorIndex (0-100%): Efficienza metabolica istantanea.
   - Morfogenesi Energetica: Crescita basata su Costo Energetico (Joules) vs Energia Accumulata.
   - Conduttanza Stomatica: Moltiplicatore efficienza 0-1 basato su VPD e stress idrico.

4. PROGRESSIONE E FASI (GAME LOOP)
-------------------------------------------------------------------------
FASE 0: PREPARAZIONE (DORMIENZA)
   - Boot sistema e Calibrazione sensori.
   - Idratazione terreno e Imbibizione seme (No tasto Start).

FASE 1: VEGETATIVA (OMEOSTASI)
   - Gestione distanza luce (stretch vs burn).
   - Prevenzione Ipossia (controllo temperatura acqua).
   - Bilanciamento nutrienti per crescita esponenziale.

FASE 2: RIPRODUTTIVA (FIORITURA)
   - Gestione pH critico (instabilità chimica).
   - Impollinazione manuale.
   - Prevenzione stress luminoso notturno (Ermafroditismo).

FASE 3: SENESCENZA (RACCOLTO)
   - Decadimento genetico programmato.
   - Obiettivo: Raccolta semi per la Data Bank.

5. MAPPATURA DATI (IMPLEMENTATION MAP)
-------------------------------------------------------------------------
Collegamento diretto tra concetti scientifici e file C# in Assets/Scripts/Data/

| Entità            | Script C#          | Nuovi Dati Chiave (Scientifici)             |
|-------------------|--------------------|---------------------------------------------|
| Atmosphere        | AtmosphereData.cs  | co2Moles, dewPoint, jouleInput, vaporPressure |
| Plant Model       | PlantState.cs      | vigorIndex, imbibitionLevel, currentRootVolume |
| DNA Specie        | PlantGenetics.cs   | toleranceCurves (Struct), nodeEnergyCost, senescenceFactor |
| Chemistry         | SoilData.cs        | interactionMatrix (Mulder), currentPH, dissolvedOxygen (DO) |
| Physics           | GasLaws.cs         | henryConstant, oxygenSolubilityCurve        |
| Hardware          | HardwareComponent.cs | reliabilityIndex (MTBF), sensorDrift, timeSinceCalibration |
| Hardware          | Actuator_Light.cs  | inverseSquareLaw (bool), sourcePPFD         |
| Biology           | Metabolism.cs      | stomatalConductance (0-1), hypoxiaStress    |
